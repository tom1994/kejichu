<?php require '../../../zb_system/function/c_system_base.php';require '../../../zb_system/function/c_system_admin.php';$zbp->Load();$action='root';if (!$zbp->CheckRights($action)) {$zbp->ShowError(6);die();}if (!$zbp->CheckPlugin('ResponsiveSlides')) {$zbp->ShowError(48);die();}$blogtitle=$zbp->theme.'插件配置->添加幻灯片';if ($_POST && isset($_POST)) {	if ($_GET && isset($_GET['type'])) {		if ($_GET['type'] == 'add') {			if($zbp->Config('ResponsiveSlides')->HasKey('slidesArray')){$slidesArray = json_decode($zbp->Config('ResponsiveSlides')->slidesArray,true);}			$slidesArray[] = $_POST;			foreach ($slidesArray as $key => $row) {			    $order[$key] = $row['order'];			    $title[$key]  = $row['title'];			}			array_multisort($order, SORT_ASC, $title, SORT_DESC, $slidesArray);			$zbp->Config('ResponsiveSlides')->slidesArray = json_encode($slidesArray);			$zbp->SaveConfig('ResponsiveSlides');		} elseif ($_GET['type'] == 'edit') {			$slidesArray = json_decode($zbp->Config('ResponsiveSlides')->slidesArray,true);			$editid = $_POST['editid'];			unset($_POST['editid']);			$slidesArray[$editid] =$_POST;			foreach ($slidesArray as $key => $row) {			    $order[$key] = $row['order'];			    $title[$key]  = $row['title'];			}			array_multisort($order, SORT_ASC, $title, SORT_DESC, $slidesArray);			$zbp->Config('ResponsiveSlides')->slidesArray = json_encode($slidesArray);			$zbp->SaveConfig('ResponsiveSlides');		}	}} elseif ($_GET && isset($_GET)) {	if ($_GET['type'] == 'del') {		$slidesArray = json_decode($zbp->Config('ResponsiveSlides')->slidesArray,true);		$editid = $_GET['id'];		unset($slidesArray[$editid]);		$zbp->Config('ResponsiveSlides')->slidesArray = json_encode($slidesArray);		$zbp->SaveConfig('ResponsiveSlides');	}}if($zbp->Config('ResponsiveSlides')->HasKey('slidesArray')){	$slidesArray = json_decode($zbp->Config('ResponsiveSlides')->slidesArray,true);}else{	$slidesArray = array();}require $blogpath . 'zb_system/admin/admin_header.php';require $blogpath . 'zb_system/admin/admin_top.php';?><style>.uplod_img {width:60%;}.uploadimg strong {cursor:pointer; background:#3A6EA5; width:15%; text-align:center; padding:5px 0; color:#fff; display:block; float:right;}.uploadimg img {width:15%; height:auto; float:left; display:inline-block; margin-right:5%;}.uploadimg input {float:left;}input.sedit{ width:93%;}table input{margin:0.25em 0;}table input.text{padding: 2px 5px;}table .button{padding: 2px 12px 5px 12px; margin: 0.25em 0;}</style><div id="divMain">	<div class="divHeader"><?php echo $blogtitle;?></div>	<div class="SubMenu">        <?php ResponsiveSlides_SubMenu(1);?>    </div>	<div id="divMain2">	<table width="100%" style='padding:0;margin:0;' cellspacing='0' cellpadding='0' class="tableBorder">		<tr height="32"><td  style="color:#F00"><strong>温馨提示：</strong>上传图片功能需要安装启用<strong>UEditor编辑器</strong>插件，否则只能输入图片URL地址，zblog php自带UEditor编辑器，直接在插件管理中启用即可。</td></tr>	</table>	<form action="?type=add" method="post">	<table width="100%" border="1" class="tableBorder">	<tr>		<th scope="col" width="5%" height="32" nowrap="nowrap">序号</th>		<th scope="col" width="20%">标题</th>		<th scope="col" width="35%">图片</th>		<th scope="col" width="20%">链接</th>		<th scope="col" width="5%">排序</th>		<th scope="col" width="10%">操作</th>	</tr><tr><td align="center"></td><td><input type="text" class="sedit" name="title" value=""></td><td><div class="uploadimg"><input type="text" class="uplod_img" name="img" value=""><strong>上传图片</strong></div></td><td><input type="text" class="sedit" name="url" value=""></td><td><input type="text" name="order" value="" style="width:40px"></td><td><input type="submit" class="button" value="增加"/></td></tr></form><?phpforeach ($slidesArray as $key => $value) {	echo <<<eof	<form action="?type=edit" method="post">	<tr><td align="center">{$key}</td><input type="hidden" name="editid" value="{$key}"><td><input type="text" class="sedit" name="title" value="{$value['title']}" ></td><td><div class="uploadimg"><img src="{$value['img']}"/><input type="text" class="uplod_img" name="img" value="{$value['img']}" ><strong>上传图片</strong></div></td><td><input type="text" class="sedit" name="url" value="{$value['url']}" ></td><td><input type="text" class="sedit" name="order" value="{$value['order']}" style="width:40px"></td><td nowrap="nowrap"><input type="submit" class="button" value="修改"/><input type="button" class="button" value="删除" onclick="if(confirm('您确定要进行删除操作吗？')){location.href='?type=del&id={$key}'}"/></td></tr></form>eof;}?></table>	</div>	<table width="100%" style='padding:0;margin:0 0 20px;' cellspacing='0' cellpadding='0' class="tableBorder">		<p>1、把 {ResponsiveSlides_call('')} 放到要显示位置对应的当前主题template/目录下的模板文件</p>		<p>2、然后返回后台首页，点击[清空缓存并重新编译模板]即可生效</p>		<p>3、有问题请到插件发布页面留言：<a href="http://www.boke8.net/zbpResponsiveSlides.html" target="_blank">http://www.boke8.net/zbpResponsiveSlides.html</a></p>			</table></div><?phpif ($zbp->CheckPlugin('UEditor')) {		echo '<script type="text/javascript" src="'.$zbp->host.'zb_users/plugin/UEditor/ueditor.config.php"></script>';	echo '<script type="text/javascript" src="'.$zbp->host.'zb_users/plugin/UEditor/ueditor.all.min.js"></script>';	echo "<script type=\"text/javascript\" src=\"js/lib.upload.js\"></script>";}require $blogpath . 'zb_system/admin/admin_footer.php';RunTime();?>